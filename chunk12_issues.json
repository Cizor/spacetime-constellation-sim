[
    {
        "url":  "https://api.github.com/repos/Cizor/spacetime-constellation-sim/issues/178",
        "repository_url":  "https://api.github.com/repos/Cizor/spacetime-constellation-sim",
        "labels_url":  "https://api.github.com/repos/Cizor/spacetime-constellation-sim/issues/178/labels{/name}",
        "comments_url":  "https://api.github.com/repos/Cizor/spacetime-constellation-sim/issues/178/comments",
        "events_url":  "https://api.github.com/repos/Cizor/spacetime-constellation-sim/issues/178/events",
        "html_url":  "https://github.com/Cizor/spacetime-constellation-sim/issues/178",
        "id":  3715276916,
        "node_id":  "I_kwDOQfMfks7dcqB0",
        "number":  178,
        "title":  "[Scope 4][Chunk 12] Epic – Observability, logging \u0026 developer experience for SBI",
        "user":  {
                     "login":  "Cizor",
                     "id":  11782718,
                     "node_id":  "MDQ6VXNlcjExNzgyNzE4",
                     "avatar_url":  "https://avatars.githubusercontent.com/u/11782718?v=4",
                     "gravatar_id":  "",
                     "url":  "https://api.github.com/users/Cizor",
                     "html_url":  "https://github.com/Cizor",
                     "followers_url":  "https://api.github.com/users/Cizor/followers",
                     "following_url":  "https://api.github.com/users/Cizor/following{/other_user}",
                     "gists_url":  "https://api.github.com/users/Cizor/gists{/gist_id}",
                     "starred_url":  "https://api.github.com/users/Cizor/starred{/owner}{/repo}",
                     "subscriptions_url":  "https://api.github.com/users/Cizor/subscriptions",
                     "organizations_url":  "https://api.github.com/users/Cizor/orgs",
                     "repos_url":  "https://api.github.com/users/Cizor/repos",
                     "events_url":  "https://api.github.com/users/Cizor/events{/privacy}",
                     "received_events_url":  "https://api.github.com/users/Cizor/received_events",
                     "type":  "User",
                     "user_view_type":  "public",
                     "site_admin":  false
                 },
        "labels":  [
                       {
                           "id":  9738572054,
                           "node_id":  "LA_kwDOQfMfks8AAAACRHbRFg",
                           "url":  "https://api.github.com/repos/Cizor/spacetime-constellation-sim/labels/type:tracking",
                           "name":  "type:tracking",
                           "color":  "4eaa16",
                           "default":  false,
                           "description":  ""
                       },
                       {
                           "id":  9782134341,
                           "node_id":  "LA_kwDOQfMfks8AAAACRw-GRQ",
                           "url":  "https://api.github.com/repos/Cizor/spacetime-constellation-sim/labels/scope:4-sbi",
                           "name":  "scope:4-sbi",
                           "color":  "5a2e28",
                           "default":  false,
                           "description":  ""
                       },
                       {
                           "id":  9782142254,
                           "node_id":  "LA_kwDOQfMfks8AAAACRw-lLg",
                           "url":  "https://api.github.com/repos/Cizor/spacetime-constellation-sim/labels/chunk:12-sbi-observability",
                           "name":  "chunk:12-sbi-observability",
                           "color":  "51f0bd",
                           "default":  false,
                           "description":  ""
                       }
                   ],
        "state":  "open",
        "locked":  false,
        "assignee":  {
                         "login":  "Cizor",
                         "id":  11782718,
                         "node_id":  "MDQ6VXNlcjExNzgyNzE4",
                         "avatar_url":  "https://avatars.githubusercontent.com/u/11782718?v=4",
                         "gravatar_id":  "",
                         "url":  "https://api.github.com/users/Cizor",
                         "html_url":  "https://github.com/Cizor",
                         "followers_url":  "https://api.github.com/users/Cizor/followers",
                         "following_url":  "https://api.github.com/users/Cizor/following{/other_user}",
                         "gists_url":  "https://api.github.com/users/Cizor/gists{/gist_id}",
                         "starred_url":  "https://api.github.com/users/Cizor/starred{/owner}{/repo}",
                         "subscriptions_url":  "https://api.github.com/users/Cizor/subscriptions",
                         "organizations_url":  "https://api.github.com/users/Cizor/orgs",
                         "repos_url":  "https://api.github.com/users/Cizor/repos",
                         "events_url":  "https://api.github.com/users/Cizor/events{/privacy}",
                         "received_events_url":  "https://api.github.com/users/Cizor/received_events",
                         "type":  "User",
                         "user_view_type":  "public",
                         "site_admin":  false
                     },
        "assignees":  [
                          {
                              "login":  "Cizor",
                              "id":  11782718,
                              "node_id":  "MDQ6VXNlcjExNzgyNzE4",
                              "avatar_url":  "https://avatars.githubusercontent.com/u/11782718?v=4",
                              "gravatar_id":  "",
                              "url":  "https://api.github.com/users/Cizor",
                              "html_url":  "https://github.com/Cizor",
                              "followers_url":  "https://api.github.com/users/Cizor/followers",
                              "following_url":  "https://api.github.com/users/Cizor/following{/other_user}",
                              "gists_url":  "https://api.github.com/users/Cizor/gists{/gist_id}",
                              "starred_url":  "https://api.github.com/users/Cizor/starred{/owner}{/repo}",
                              "subscriptions_url":  "https://api.github.com/users/Cizor/subscriptions",
                              "organizations_url":  "https://api.github.com/users/Cizor/orgs",
                              "repos_url":  "https://api.github.com/users/Cizor/repos",
                              "events_url":  "https://api.github.com/users/Cizor/events{/privacy}",
                              "received_events_url":  "https://api.github.com/users/Cizor/received_events",
                              "type":  "User",
                              "user_view_type":  "public",
                              "site_admin":  false
                          }
                      ],
        "milestone":  {
                          "url":  "https://api.github.com/repos/Cizor/spacetime-constellation-sim/milestones/4",
                          "html_url":  "https://github.com/Cizor/spacetime-constellation-sim/milestone/4",
                          "labels_url":  "https://api.github.com/repos/Cizor/spacetime-constellation-sim/milestones/4/labels",
                          "id":  14244293,
                          "node_id":  "MI_kwDOQfMfks4A2VnF",
                          "number":  4,
                          "title":  "Scope 4 – Planning \u0026 Scheduling",
                          "description":  "",
                          "creator":  {
                                          "login":  "Cizor",
                                          "id":  11782718,
                                          "node_id":  "MDQ6VXNlcjExNzgyNzE4",
                                          "avatar_url":  "https://avatars.githubusercontent.com/u/11782718?v=4",
                                          "gravatar_id":  "",
                                          "url":  "https://api.github.com/users/Cizor",
                                          "html_url":  "https://github.com/Cizor",
                                          "followers_url":  "https://api.github.com/users/Cizor/followers",
                                          "following_url":  "https://api.github.com/users/Cizor/following{/other_user}",
                                          "gists_url":  "https://api.github.com/users/Cizor/gists{/gist_id}",
                                          "starred_url":  "https://api.github.com/users/Cizor/starred{/owner}{/repo}",
                                          "subscriptions_url":  "https://api.github.com/users/Cizor/subscriptions",
                                          "organizations_url":  "https://api.github.com/users/Cizor/orgs",
                                          "repos_url":  "https://api.github.com/users/Cizor/repos",
                                          "events_url":  "https://api.github.com/users/Cizor/events{/privacy}",
                                          "received_events_url":  "https://api.github.com/users/Cizor/received_events",
                                          "type":  "User",
                                          "user_view_type":  "public",
                                          "site_admin":  false
                                      },
                          "open_issues":  73,
                          "closed_issues":  0,
                          "state":  "open",
                          "created_at":  "2025-11-29T09:54:27Z",
                          "updated_at":  "2025-12-10T17:09:37Z",
                          "due_on":  null,
                          "closed_at":  null
                      },
        "comments":  0,
        "created_at":  "2025-12-10T13:46:04Z",
        "updated_at":  "2025-12-10T13:46:04Z",
        "closed_at":  null,
        "author_association":  "OWNER",
        "active_lock_reason":  null,
        "sub_issues_summary":  {
                                   "total":  3,
                                   "completed":  0,
                                   "percent_completed":  0
                               },
        "issue_dependencies_summary":  {
                                           "blocked_by":  0,
                                           "total_blocked_by":  0,
                                           "blocking":  0,
                                           "total_blocking":  0
                                       },
        "body":  "## Background\n\nBy this point in **Scope 4**, the SBI scheduling and telemetry mechanisms are in place:\n\n- CDPI server and agents:\n  - Agents connect via `ReceiveRequests` stream.\n  - Controller sends `CreateEntry`, `DeleteEntry`, `Finalize`, and handles `Reset`, `Response`.\n- Scheduling engine:\n  - Issues `ScheduledAction`s (UpdateBeam/DeleteBeam, SetRoute/DeleteRoute, minimal SrPolicy handling).\n- Telemetry path:\n  - Agents periodically emit `ExportMetrics`.\n  - Controller stores metrics in `TelemetryState`.\n\nWhat’s still missing is **good observability** for developers:\n\n- It’s hard to see what the controller actually scheduled vs what agents executed.\n- Failures in SBI streams are not surfaced clearly.\n- There’s no simple way to inspect:\n  - Pending actions per agent.\n  - Last known telemetry metrics.\n  - Basic counters (e.g. actions executed, responses OK/failed).\n\nThis epic adds **logging, lightweight metrics, and developer helpers** so that:\n\n- Scheduling and SBI behaviour is debuggable from logs.\n- You can quickly inspect agent/controller state while running tests or local scenarios.\n- Future scopes (e.g. exposing telemetry via NBI) have a clean internal observability foundation.\n\n## Goal\n\nDeliver a focused observability layer for Scope 4 SBI:\n\n- Structured logging for:\n  - CDPI server (controller side).\n  - Agents (per-node SBI behaviour).\n- Lightweight internal metrics counters (in-memory only) for:\n  - CDPI and scheduler actions.\n  - Telemetry flows.\n- Developer helper(s) to dump agent/controller state on demand:\n  - Pending scheduled actions per agent.\n  - Last telemetry metrics for that node.\n- Documentation on:\n  - How to enable/adjust logging.\n  - How to interpret the debug dumps.\n  - How to use these tools when debugging scenarios.\n\nAll of this stays **internal** (no new NBI surface), and should be cheap to run in tests.\n\n## Where to look\n\nCore SBI components:\n\n- CDPI server:\n  - Under something like:\n        internal/sbi/controller/cdpi_server.go\n  - Holds agent handles, outgoing channels, and `ScheduledAction` plumbing.\n\n- Scheduler:\n  - Under something like:\n        internal/sbi/controller/scheduler.go\n  - Where `SendCreateEntry` / `SendDeleteEntry` are called.\n\n- Agent implementation:\n  - Under something like:\n        internal/sbi/agent/agent.go\n  - Maintains:\n        type Agent struct {\n            AgentID   string\n            NodeID    string\n            State     *simstate.ScenarioState\n            Scheduler sbi.EventScheduler\n            // CDPI stream, Telemetry client, pending actions, etc.\n        }\n\nTelemetry:\n\n- Telemetry server and state:\n      internal/sbi/telemetry_server.go\n      internal/simstate/telemetry_state.go\n  - Where `TelemetryState.UpdateMetrics` and `GetMetrics` live.\n\nExisting logging and config:\n\n- Any shared logging abstraction (e.g. `Logger` interface) already used in:\n  - NBI services.\n  - CDPI / Agent code paths.\n- Configuration / flags for the simulator:\n  - Under `cmd/simulator` or equivalent.\n\nSearch terms:\n\n- `CDPIServer`\n- `Agent struct`\n- `TelemetryState`\n- `Logger`\n- `Dump` / `String()` helpers\n\n## Tasks\n\n### 1. Structured logging for CDPI server\n\n- Extend `CDPIServer` to accept a logger:\n\n      type CDPIServer struct {\n          scheduling.UnimplementedControlDataPlaneInterfaceServer\n\n          State *simstate.ScenarioState\n          Clock sbi.EventScheduler\n\n          agentsMu sync.RWMutex\n          agents   map[string]*AgentHandle\n\n          Logger Logger // or *zap.Logger / similar, depending on existing infra\n      }\n\n- Add structured logs for key events:\n\n  - Agent stream lifecycle:\n\n    - On agent Hello:\n      - Log agent ID, associated NodeID.\n    - On stream closure / error:\n      - Log agent ID, error reason.\n\n  - Schedule manipulation:\n\n    - When sending `CreateEntryRequest`:\n      - `agent_id`, `entry_id`, `when`, `type`, `seq_no`, `token`.\n    - When sending `DeleteEntryRequest`:\n      - `agent_id`, `entry_id`, `seq_no`, `token`.\n    - When sending `FinalizeRequest`:\n      - `agent_id`, `cutoff_time`.\n\n  - Responses and Reset:\n\n    - On `Reset` from agent:\n      - `agent_id`, new token.\n    - On `Response` from agent:\n      - `agent_id`, `request_id`, `status`, and optional error / message.\n\n- Keep logs concise but structured (e.g. key-value pairs) so tests and developers can grep easily.\n\n### 2. Structured logging for Agent behaviour\n\n- Extend `Agent` to hold a logger if not already present:\n\n      type Agent struct {\n          AgentID   string\n          NodeID    string\n          State     *simstate.ScenarioState\n          Scheduler sbi.EventScheduler\n          // ...\n          Logger Logger\n      }\n\n- Log major events:\n\n  - Lifecycle:\n\n    - On `Start`:\n      - `agent_id`, `node_id`, initial token.\n    - On `Stop`:\n      - `agent_id`, summary of pending entries (count).\n\n  - Schedule queue:\n\n    - When receiving `CreateEntryRequest`:\n      - `entry_id`, `when`, `type`.\n    - When scheduling execution:\n      - `entry_id`, `when` (sim time).\n    - When executing an action:\n      - `entry_id`, `type`, success/failure.\n      - On failure, include error text.\n\n  - Telemetry:\n\n    - When telemetry loop starts:\n      - interval in sim seconds.\n    - Per tick (at DEBUG level):\n      - Number of interfaces reported, bytes summary.\n    - On telemetry send failure:\n      - `agent_id`, error.\n\n- Use log levels if your logger supports them:\n  - INFO for lifecycle and high-level events.\n  - DEBUG for per-tick telemetry details and internal state.\n\n### 3. Lightweight metrics counters\n\n- Introduce a small internal metrics struct, e.g.:\n\n      type SBIMetrics struct {\n          mu sync.Mutex\n\n          // CDPI / scheduler\n          CreateEntrySent   uint64\n          DeleteEntrySent   uint64\n          FinalizeSent      uint64\n          ActionsExecuted   uint64\n          ResponsesOK       uint64\n          ResponsesError    uint64\n\n          // Telemetry\n          TelemetryReports  uint64\n          TelemetryErrors   uint64\n      }\n\n- Add one instance to a central SBI context (or embed into `CDPIServer` / `Scheduler` / `Agent` as appropriate):\n\n      type SBIContext struct {\n          Metrics *SBIMetrics\n          Logger  Logger\n      }\n\n- Wire the counters:\n\n  - CDPI server:\n\n    - Increment `CreateEntrySent`, `DeleteEntrySent`, `FinalizeSent` when those messages are enqueued for agents.\n    - Increment `ResponsesOK` / `ResponsesError` based on incoming Response status.\n\n  - Agent:\n\n    - Increment `ActionsExecuted` each time an action is successfully applied to `ScenarioState`.\n    - Increment `TelemetryReports` for each successful `ExportMetrics`.\n    - Increment `TelemetryErrors` on telemetry send failures.\n\n- Provide simple accessors or a `String()` method on `SBIMetrics` for debugging:\n\n      func (m *SBIMetrics) Snapshot() SBIMetrics\n      func (m *SBIMetrics) String() string\n\n### 4. Implement `DumpAgentState` developer helper\n\n- In an SBI or controller package, add:\n\n      func DumpAgentState(a *Agent, telemetry *TelemetryState) string\n\n- Contents:\n\n  - Agent identity:\n\n        AgentID: \u003cid\u003e\n        NodeID:  \u003cnode-id\u003e\n\n  - Pending scheduled actions:\n\n    - Acquire `Agent.mu`.\n    - For each `ScheduledAction` in `pending`, print:\n      - `EntryID`, `When` (sim time), `Type`, `RequestID`, `SeqNo`.\n\n  - Last telemetry metrics for that node:\n\n    - If `TelemetryState` is provided:\n      - Iterate over interfaces for `Agent.NodeID`.\n      - For each `(nodeID, ifaceID)` present in `TelemetryState`:\n        - Print:\n          - `InterfaceID`, `Up`, `BytesTx`, optional `SNRdB`, `Modulation`.\n\n  - Metrics snapshot (if `SBIMetrics` accessible from agent or global context):\n    - Include counts: `ActionsExecuted`, `TelemetryReports`, etc.\n\n- Ensure `DumpAgentState` is:\n\n  - Safe to call from tests (no panics even if agent/telemetry is `nil`).\n  - Clearly formatted and easy to paste into logs or test failure messages.\n\n### 5. Configuration knobs for logging/observability\n\n- Add simple configuration options (flags or config struct fields):\n\n  - Log level for SBI components (e.g. `--sbi-log-level=info|debug`).\n  - Whether to include telemetry per-tick debug logs:\n    - e.g. `--sbi-log-telemetry-debug` boolean, or reuse generic log level.\n\n- In the simulator startup (e.g. `cmd/simulator/main.go`):\n\n  - Parse flags / config.\n  - Construct `Logger` instances with the configured level.\n  - Inject logger and `SBIMetrics` into:\n    - `CDPIServer`.\n    - `Scheduler`.\n    - Each `Agent`.\n    - `TelemetryServer` if appropriate.\n\n### 6. Documentation for SBI observability\n\n- Under `docs/` (or similar), add a short markdown doc, e.g.:\n\n  - `docs/sbi-observability.md`\n\n- Cover:\n\n  - How to enable SBI-specific logging (flags, config).\n  - Example log snippets:\n    - Agent connection and Hello.\n    - Create/DeleteEntry sequences.\n    - Telemetry reports.\n  - How to use `DumpAgentState`:\n    - In unit tests (e.g. log on failure).\n    - In manual debugging (e.g. REPL or debug endpoint later).\n  - Quick troubleshooting guide:\n    - “No actions executed” → check CDPI logs and `CreateEntrySent`.\n    - “No telemetry arriving” → check agent telemetry logs and `TelemetryErrors`.\n\n## Acceptance criteria\n\n- Logging:\n\n  - CDPI server logs:\n    - Agent connections (Hello/stream close).\n    - All Create/Delete/Finalize messages sent (with key fields).\n    - Resets and Responses (including status).\n  - Agent logs:\n    - Start/Stop lifecycle.\n    - Create/Delete/Finalize requests received from controller.\n    - Actions scheduled and executed (with result).\n    - Telemetry loop start and failures (optional debug for per-tick).\n\n- Metrics:\n\n  - `SBIMetrics` (or equivalent) struct exists and is incremented at key SBI events:\n    - `CreateEntrySent`, `DeleteEntrySent`, `FinalizeSent`.\n    - `ActionsExecuted`, `ResponsesOK`, `ResponsesError`.\n    - `TelemetryReports`, `TelemetryErrors`.\n  - A snapshot/`String()` helper exists to inspect current counters.\n\n- Developer helper:\n\n  - `DumpAgentState` (or similarly named function) implemented and:\n    - Prints pending scheduled actions for an `Agent`.\n    - Prints last known telemetry metrics for that agent’s node (if available).\n    - Includes a summary of SBI-related counters.\n  - Safe to call in tests and logs (no panics on nil fields).\n\n- Configuration:\n\n  - Simulator startup accepts SBI observability configuration:\n    - At least a log-level or “enable debug” toggle for SBI components.\n  - Logger and metrics objects are correctly injected into:\n    - `CDPIServer`, `Scheduler`, `Agent`, and optionally `TelemetryServer`.\n\n- Documentation:\n\n  - A `docs/sbi-observability.md` (or equivalent) file exists:\n    - Describes SBI logging and metrics.\n    - Shows how to enable and interpret logs.\n    - Shows how to use `DumpAgentState` during debugging.\n\n- Repository health:\n\n  - `go build ./...` passes with the new observability code.\n  - Existing tests still pass.\n  - New tests (if added for `DumpAgentState` / metrics) pass and are stable.\n",
        "closed_by":  null,
        "reactions":  {
                          "url":  "https://api.github.com/repos/Cizor/spacetime-constellation-sim/issues/178/reactions",
                          "total_count":  0,
                          "+1":  0,
                          "-1":  0,
                          "laugh":  0,
                          "hooray":  0,
                          "confused":  0,
                          "heart":  0,
                          "rocket":  0,
                          "eyes":  0
                      },
        "timeline_url":  "https://api.github.com/repos/Cizor/spacetime-constellation-sim/issues/178/timeline",
        "performed_via_github_app":  null,
        "state_reason":  null
    },
    {
        "url":  "https://api.github.com/repos/Cizor/spacetime-constellation-sim/issues/179",
        "repository_url":  "https://api.github.com/repos/Cizor/spacetime-constellation-sim",
        "labels_url":  "https://api.github.com/repos/Cizor/spacetime-constellation-sim/issues/179/labels{/name}",
        "comments_url":  "https://api.github.com/repos/Cizor/spacetime-constellation-sim/issues/179/comments",
        "events_url":  "https://api.github.com/repos/Cizor/spacetime-constellation-sim/issues/179/events",
        "html_url":  "https://github.com/Cizor/spacetime-constellation-sim/issues/179",
        "id":  3715489419,
        "node_id":  "I_kwDOQfMfks7ddd6L",
        "number":  179,
        "title":  "[Scope 4][Chunk 12] Add structured logging for CDPI, agents, scheduler \u0026 telemetry",
        "user":  {
                     "login":  "Cizor",
                     "id":  11782718,
                     "node_id":  "MDQ6VXNlcjExNzgyNzE4",
                     "avatar_url":  "https://avatars.githubusercontent.com/u/11782718?v=4",
                     "gravatar_id":  "",
                     "url":  "https://api.github.com/users/Cizor",
                     "html_url":  "https://github.com/Cizor",
                     "followers_url":  "https://api.github.com/users/Cizor/followers",
                     "following_url":  "https://api.github.com/users/Cizor/following{/other_user}",
                     "gists_url":  "https://api.github.com/users/Cizor/gists{/gist_id}",
                     "starred_url":  "https://api.github.com/users/Cizor/starred{/owner}{/repo}",
                     "subscriptions_url":  "https://api.github.com/users/Cizor/subscriptions",
                     "organizations_url":  "https://api.github.com/users/Cizor/orgs",
                     "repos_url":  "https://api.github.com/users/Cizor/repos",
                     "events_url":  "https://api.github.com/users/Cizor/events{/privacy}",
                     "received_events_url":  "https://api.github.com/users/Cizor/received_events",
                     "type":  "User",
                     "user_view_type":  "public",
                     "site_admin":  false
                 },
        "labels":  [
                       {
                           "id":  9737890014,
                           "node_id":  "LA_kwDOQfMfks8AAAACRGxo3g",
                           "url":  "https://api.github.com/repos/Cizor/spacetime-constellation-sim/labels/type:feature",
                           "name":  "type:feature",
                           "color":  "942327",
                           "default":  false,
                           "description":  ""
                       },
                       {
                           "id":  9782134341,
                           "node_id":  "LA_kwDOQfMfks8AAAACRw-GRQ",
                           "url":  "https://api.github.com/repos/Cizor/spacetime-constellation-sim/labels/scope:4-sbi",
                           "name":  "scope:4-sbi",
                           "color":  "5a2e28",
                           "default":  false,
                           "description":  ""
                       },
                       {
                           "id":  9782142254,
                           "node_id":  "LA_kwDOQfMfks8AAAACRw-lLg",
                           "url":  "https://api.github.com/repos/Cizor/spacetime-constellation-sim/labels/chunk:12-sbi-observability",
                           "name":  "chunk:12-sbi-observability",
                           "color":  "51f0bd",
                           "default":  false,
                           "description":  ""
                       }
                   ],
        "state":  "open",
        "locked":  false,
        "assignee":  {
                         "login":  "Cizor",
                         "id":  11782718,
                         "node_id":  "MDQ6VXNlcjExNzgyNzE4",
                         "avatar_url":  "https://avatars.githubusercontent.com/u/11782718?v=4",
                         "gravatar_id":  "",
                         "url":  "https://api.github.com/users/Cizor",
                         "html_url":  "https://github.com/Cizor",
                         "followers_url":  "https://api.github.com/users/Cizor/followers",
                         "following_url":  "https://api.github.com/users/Cizor/following{/other_user}",
                         "gists_url":  "https://api.github.com/users/Cizor/gists{/gist_id}",
                         "starred_url":  "https://api.github.com/users/Cizor/starred{/owner}{/repo}",
                         "subscriptions_url":  "https://api.github.com/users/Cizor/subscriptions",
                         "organizations_url":  "https://api.github.com/users/Cizor/orgs",
                         "repos_url":  "https://api.github.com/users/Cizor/repos",
                         "events_url":  "https://api.github.com/users/Cizor/events{/privacy}",
                         "received_events_url":  "https://api.github.com/users/Cizor/received_events",
                         "type":  "User",
                         "user_view_type":  "public",
                         "site_admin":  false
                     },
        "assignees":  [
                          {
                              "login":  "Cizor",
                              "id":  11782718,
                              "node_id":  "MDQ6VXNlcjExNzgyNzE4",
                              "avatar_url":  "https://avatars.githubusercontent.com/u/11782718?v=4",
                              "gravatar_id":  "",
                              "url":  "https://api.github.com/users/Cizor",
                              "html_url":  "https://github.com/Cizor",
                              "followers_url":  "https://api.github.com/users/Cizor/followers",
                              "following_url":  "https://api.github.com/users/Cizor/following{/other_user}",
                              "gists_url":  "https://api.github.com/users/Cizor/gists{/gist_id}",
                              "starred_url":  "https://api.github.com/users/Cizor/starred{/owner}{/repo}",
                              "subscriptions_url":  "https://api.github.com/users/Cizor/subscriptions",
                              "organizations_url":  "https://api.github.com/users/Cizor/orgs",
                              "repos_url":  "https://api.github.com/users/Cizor/repos",
                              "events_url":  "https://api.github.com/users/Cizor/events{/privacy}",
                              "received_events_url":  "https://api.github.com/users/Cizor/received_events",
                              "type":  "User",
                              "user_view_type":  "public",
                              "site_admin":  false
                          }
                      ],
        "milestone":  {
                          "url":  "https://api.github.com/repos/Cizor/spacetime-constellation-sim/milestones/4",
                          "html_url":  "https://github.com/Cizor/spacetime-constellation-sim/milestone/4",
                          "labels_url":  "https://api.github.com/repos/Cizor/spacetime-constellation-sim/milestones/4/labels",
                          "id":  14244293,
                          "node_id":  "MI_kwDOQfMfks4A2VnF",
                          "number":  4,
                          "title":  "Scope 4 – Planning \u0026 Scheduling",
                          "description":  "",
                          "creator":  {
                                          "login":  "Cizor",
                                          "id":  11782718,
                                          "node_id":  "MDQ6VXNlcjExNzgyNzE4",
                                          "avatar_url":  "https://avatars.githubusercontent.com/u/11782718?v=4",
                                          "gravatar_id":  "",
                                          "url":  "https://api.github.com/users/Cizor",
                                          "html_url":  "https://github.com/Cizor",
                                          "followers_url":  "https://api.github.com/users/Cizor/followers",
                                          "following_url":  "https://api.github.com/users/Cizor/following{/other_user}",
                                          "gists_url":  "https://api.github.com/users/Cizor/gists{/gist_id}",
                                          "starred_url":  "https://api.github.com/users/Cizor/starred{/owner}{/repo}",
                                          "subscriptions_url":  "https://api.github.com/users/Cizor/subscriptions",
                                          "organizations_url":  "https://api.github.com/users/Cizor/orgs",
                                          "repos_url":  "https://api.github.com/users/Cizor/repos",
                                          "events_url":  "https://api.github.com/users/Cizor/events{/privacy}",
                                          "received_events_url":  "https://api.github.com/users/Cizor/received_events",
                                          "type":  "User",
                                          "user_view_type":  "public",
                                          "site_admin":  false
                                      },
                          "open_issues":  73,
                          "closed_issues":  0,
                          "state":  "open",
                          "created_at":  "2025-11-29T09:54:27Z",
                          "updated_at":  "2025-12-10T17:09:37Z",
                          "due_on":  null,
                          "closed_at":  null
                      },
        "comments":  0,
        "created_at":  "2025-12-10T14:41:06Z",
        "updated_at":  "2025-12-10T14:41:07Z",
        "closed_at":  null,
        "author_association":  "OWNER",
        "active_lock_reason":  null,
        "sub_issues_summary":  {
                                   "total":  0,
                                   "completed":  0,
                                   "percent_completed":  0
                               },
        "parent_issue_url":  "https://api.github.com/repos/Cizor/spacetime-constellation-sim/issues/178",
        "issue_dependencies_summary":  {
                                           "blocked_by":  0,
                                           "total_blocked_by":  0,
                                           "blocking":  0,
                                           "total_blocking":  0
                                       },
        "body":  "## Background\n\nScope 4 introduces a non-trivial SBI stack:\n\n- CDPI server on the controller:\n  - Handles `ReceiveRequests` streams from multiple agents.\n  - Sends `CreateEntry`, `DeleteEntry`, `Finalize`, and (optionally) `SetSrPolicy` / `DeleteSrPolicy`.\n  - Receives `Hello`, `Reset`, and `Response` messages.\n- Per-node Agents:\n  - Maintain a local schedule of `ScheduledAction`s via `EventScheduler`.\n  - Execute beam/route actions against `ScenarioState`.\n  - Emit telemetry via `TelemetryService.ExportMetrics`.\n- Controller-side TelemetryService:\n  - Receives `ExportMetricsRequest`.\n  - Updates `TelemetryState` with per-interface metrics.\n\nRight now, most of this code is either lightly logged or only uses ad-hoc `fmt.Printf`-style debugging. For Scope 4 to be debuggable in real scenarios, we need consistent **structured logging** across:\n\n- CDPI server (controller-side SBI scheduling stream).\n- Agents (per-node schedule execution).\n- Telemetry (agent emission + controller ingestion).\n- Scheduler (Chunk 8) where it exists.\n\nThe design goal is:\n\n- Make it easy to trace:\n  - “What did the scheduler tell agent X to do?”\n  - “Did agent X schedule \u0026 execute the action at the right time?”\n  - “Did we get telemetry for the links/routes that should be active?”\n- Without:\n  - Dumping huge volumes of unstructured logs.\n  - Tight-coupling to a specific logging backend.\n\nThis issue focuses on **adding structured logging hooks and a minimal logging interface**, not wiring to external logging systems.\n\n## Goal\n\nIntroduce a small, consistent logging abstraction and use it to emit structured logs for:\n\n- CDPI server major events.\n- Agent lifecycle \u0026 schedule execution.\n- Telemetry server ingest.\n- (Optionally) Scheduler decisions where it is already implemented.\n\nThe logging should:\n\n- Be safe to call from hot paths.\n- Use a simple key–value style, so it can be consumed by text logs now and structured systems later.\n- Be configurable at least by log level (e.g. INFO vs DEBUG).\n\n## Where to look\n\n- CDPI server (controller):\n\n  - `internal/sbi/controller/cdpi_server.go` (or equivalent).\n  - Types like:\n\n        type CDPIServer struct {\n            scheduling.UnimplementedControlDataPlaneInterfaceServer\n\n            State    *simstate.ScenarioState\n            Clock    sbi.EventScheduler\n            agentsMu sync.RWMutex\n            agents   map[string]*AgentHandle\n            Logger   Logger // to be added\n        }\n\n        type AgentHandle struct {\n            AgentID  string\n            NodeID   string\n            Stream   scheduling.ControlDataPlaneInterface_ReceiveRequestsServer\n            outgoing chan *scheduling.ReceiveRequestsMessageFromController\n            token    string\n        }\n\n- Agent implementation:\n\n  - `internal/sbi/agent/agent.go` (or similar).\n  - `Agent` struct where we already have:\n    - `AgentID`, `NodeID`.\n    - `State`, `Scheduler`, CDPI stream, telemetry client.\n    - Telemetry loop fields from Chunk 6.\n\n- Telemetry server:\n\n  - `internal/sbi/controller/telemetry_server.go` (or similar).\n  - `TelemetryServer` type that implements `TelemetryServiceServer`.\n\n- Scheduler (Chunk 8):\n\n  - `internal/sbi/controller/scheduler.go`.\n  - Where scheduled actions are created and `SendCreateEntry` / `SendDeleteEntry` / `SendFinalize` are called.\n\nSearch terms:\n\n- `CDPIServer`\n- `Agent struct`\n- `TelemetryServer`\n- `Scheduler struct`\n- `Logger` (if any existing minimal logging helpers)\n\n## Tasks\n\n### 1. Define a minimal Logger interface\n\nIntroduce a small logging abstraction in a shared SBI package, for example `internal/sbi/logging` or directly in `internal/sbi`:\n\n- Define an interface:\n\n      type Logger interface {\n          Debug(msg string, kv ...any)\n          Info(msg string, kv ...any)\n          Warn(msg string, kv ...any)\n          Error(msg string, kv ...any)\n      }\n\n- Provide a simple default implementation, e.g. `StdLogger`:\n\n      type StdLogger struct {\n          Level LogLevel\n      }\n\n      type LogLevel int\n\n      const (\n          LevelDebug LogLevel = iota\n          LevelInfo\n          LevelWarn\n          LevelError\n      )\n\n      func (l *StdLogger) Debug(msg string, kv ...any) { /* no-op if Level \u003e Debug */ }\n      func (l *StdLogger) Info(msg string, kv ...any)  { /* print line with key=val pairs */ }\n      func (l *StdLogger) Warn(msg string, kv ...any)  { /* ... */ }\n      func (l *StdLogger) Error(msg string, kv ...any) { /* ... */ }\n\nNotes:\n\n- For now, it’s fine to have a naive implementation using `log.Printf` with a simple `msg key=value key2=value2` format.\n- Keep the interface small so it can later be wired to `zap`, `slog`, or any other backend.\n- Provide a helper constructor, e.g. `NewStdLogger(level LogLevel) *StdLogger`.\n\n### 2. Thread Logger through CDPIServer\n\nExtend `CDPIServer`:\n\n- Add a `Logger` field:\n\n      type CDPIServer struct {\n          scheduling.UnimplementedControlDataPlaneInterfaceServer\n\n          State    *simstate.ScenarioState\n          Clock    sbi.EventScheduler\n          agentsMu sync.RWMutex\n          agents   map[string]*AgentHandle\n\n          Logger sbi.Logger\n      }\n\n- Ensure construction helpers (e.g. `NewCDPIServer`) accept a `Logger`, defaulting to `NewStdLogger(LevelInfo)` if nil.\n\nAdd logs for key events:\n\n- Agent connection:\n\n  - When `ReceiveRequests` sees the initial `Hello`:\n\n        s.Logger.Info(\"cdpi: agent connected\",\n            \"agent_id\", agentID,\n            \"node_id\", nodeID,\n        )\n\n- Agent reset:\n\n        s.Logger.Info(\"cdpi: agent reset\",\n            \"agent_id\", agentID,\n            \"token\", newToken,\n        )\n\n- CreateEntry / DeleteEntry / Finalize send:\n\n  - Inside `SendCreateEntry` / `SendDeleteEntry` / `SendFinalize`:\n\n        s.Logger.Debug(\"cdpi: send create entry\",\n            \"agent_id\", agentID,\n            \"entry_id\", action.EntryID,\n            \"when\", action.When,\n            \"type\", action.Type,\n        )\n\n        s.Logger.Debug(\"cdpi: send delete entry\",\n            \"agent_id\", agentID,\n            \"entry_id\", entryID,\n        )\n\n        s.Logger.Debug(\"cdpi: send finalize\",\n            \"agent_id\", agentID,\n            \"cutoff\", cutoff,\n        )\n\n- Responses from agents:\n\n  - In stream read loop when agent sends a `Response`:\n\n        s.Logger.Debug(\"cdpi: response from agent\",\n            \"agent_id\", agentID,\n            \"request_id\", resp.RequestId,\n            \"status\", resp.Status,\n        )\n\n- Errors:\n\n  - Stream errors, missing agent entries, etc., should log via `Warn` or `Error`.\n\n### 3. Add Logger to Agent and log lifecycle \u0026 execution\n\nExtend `Agent` struct to include a logger:\n\n- Add field:\n\n      type Agent struct {\n          AgentID   string\n          NodeID    string\n          State     *simstate.ScenarioState\n          Scheduler sbi.EventScheduler\n\n          TelemetryClient telemetry.TelemetryServiceClient\n          TelemetryInterval time.Duration\n\n          Stream scheduling.ControlDataPlaneInterface_ReceiveRequestsClient\n\n          // scheduling, telemetry, etc...\n          Logger sbi.Logger\n      }\n\n- Ensure Agent constructors (or wiring in Chunk 9) pass a logger (or default).\n\nAdd logs:\n\n- Start/Stop:\n\n      func (a *Agent) Start(ctx context.Context) error {\n          if a.Logger != nil {\n              a.Logger.Info(\"agent: start\",\n                  \"agent_id\", a.AgentID,\n                  \"node_id\", a.NodeID,\n              )\n          }\n          // existing startup logic...\n      }\n\n      func (a *Agent) Stop() {\n          if a.Logger != nil {\n              a.Logger.Info(\"agent: stop\",\n                  \"agent_id\", a.AgentID,\n                  \"node_id\", a.NodeID,\n              )\n          }\n          // cleanup...\n      }\n\n- Scheduling actions (when Agent receives `CreateEntry` / `DeleteEntry` / `Finalize`):\n\n      a.Logger.Debug(\"agent: schedule action\",\n          \"agent_id\", a.AgentID,\n          \"entry_id\", act.EntryID,\n          \"when\", act.When,\n          \"type\", act.Type,\n      )\n\n- Executing actions:\n\n      a.Logger.Debug(\"agent: execute action\",\n          \"agent_id\", a.AgentID,\n          \"entry_id\", act.EntryID,\n          \"type\", act.Type,\n      )\n\n- Errors applying KB updates:\n\n      a.Logger.Warn(\"agent: action failed\",\n          \"agent_id\", a.AgentID,\n          \"entry_id\", act.EntryID,\n          \"err\", err,\n      )\n\n- Telemetry ticks (DEBUG-level):\n\n      a.Logger.Debug(\"agent: telemetry tick\",\n          \"agent_id\", a.AgentID,\n          \"node_id\", a.NodeID,\n          \"num_if\", len(metrics),\n      )\n\n- Telemetry export errors (already similar from Chunk 6, but convert to new `Logger`):\n\n      a.Logger.Warn(\"agent: telemetry export failed\",\n          \"agent_id\", a.AgentID,\n          \"err\", err,\n      )\n\n### 4. Add Logger to TelemetryServer\n\nExtend `TelemetryServer`:\n\n- Add field:\n\n      type TelemetryServer struct {\n          telemetry.UnimplementedTelemetryServiceServer\n\n          Telemetry *TelemetryState\n          Logger    sbi.Logger\n      }\n\n- In `ExportMetrics`:\n\n      s.Logger.Debug(\"telemetry: export metrics\",\n          \"num_if\", len(req.InterfaceMetrics),\n      )\n\n      for _, im := range req.InterfaceMetrics {\n          s.Logger.Debug(\"telemetry: interface metrics\",\n              \"node_id\", im.NodeId,\n              \"iface_id\", im.InterfaceId,\n              \"up\", im.Up,\n              \"bytes_tx\", im.BytesTx,\n          )\n      }\n\n- Log errors if any validation or update fails.\n\n### 5. Optional: Scheduler logging hooks\n\nIf the Scheduler (Chunk 8) is already in place, extend it with logger:\n\n- Add `Logger sbi.Logger` to the `Scheduler` struct.\n- Log:\n\n  - When computing schedules:\n\n        s.Logger.Info(\"scheduler: run\",\n            \"time\", s.Clock.Now(),\n        )\n\n  - When emitting CreateEntry/Finalize:\n\n        s.Logger.Debug(\"scheduler: schedule link interval\",\n            \"link_id\", linkID,\n            \"agent_id\", agentID,\n            \"t_on\", tOn,\n            \"t_off\", tOff,\n        )\n\n### 6. Configuration \u0026 wiring\n\n- Decide a default logging level (e.g. INFO).\n- In the main wiring (Chunk 9):\n\n  - Create one or more `Logger` instances (e.g. shared `StdLogger`).\n  - Pass them into:\n    - `CDPIServer`.\n    - `TelemetryServer`.\n    - `Scheduler`.\n    - Each `Agent`.\n\n- Optionally add config hooks (not mandatory in this issue):\n\n  - Command-line flag or config file setting for log level.\n\n### 7. Tests \u0026 sanity checks\n\n- Add simple tests for `StdLogger`:\n\n  - At least verify that:\n    - Calling `Debug` doesn’t panic when `Level` is INFO.\n    - Methods accept odd numbers of `kv` args gracefully (either ignore last or log anyway).\n  - You don’t need heavy assertions on output, but you can test formatting helpers if extracted.\n\n- For CDPI / Agent / Telemetry tests:\n\n  - It’s enough to:\n    - Inject a no-op logger (`NilLogger`) in existing unit tests to avoid noisy output.\n    - Optionally add a small test with a fake logger that records calls to ensure no nil dereferences and some key events are logged.\n\n## Acceptance criteria\n\n- Logging abstraction:\n\n  - `Logger` interface exists with `Debug`, `Info`, `Warn`, `Error`.\n  - `StdLogger` (or similar) default implementation provided.\n  - It is safe to use from multiple goroutines.\n\n- CDPI server logging:\n\n  - Logs agent connections (`Hello`), resets, and stream closures.\n  - Logs all outgoing Create/Delete/Finalize actions with `agent_id`, `entry_id`, `when`, `type`.\n  - Logs responses from agents with `agent_id`, `request_id`, and `status`.\n\n- Agent logging:\n\n  - Logs startup and shutdown with `agent_id` and `node_id`.\n  - Logs schedule operations:\n    - When actions are scheduled (CreateEntry).\n    - When actions are cancelled (DeleteEntry / Finalize).\n    - When actions execute and when they fail KB updates.\n  - Logs telemetry ticks (at DEBUG level) and ExportMetrics failures (at WARN/ERROR).\n\n- Telemetry logging:\n\n  - `TelemetryServer` logs in-bound `ExportMetricsRequest` summaries.\n  - Optionally logs per-interface metrics at DEBUG level.\n  - Logs any update/validation errors when updating `TelemetryState`.\n\n- Wiring:\n\n  - CDPIServer, Scheduler (if present), Agents, and TelemetryServer all accept a `Logger` and use it, defaulting to a sane `StdLogger` if none is provided.\n  - Existing unit tests pass using a no-op logger where necessary.\n\n- Repository health:\n\n  - `go build ./...` passes with the new logging abstractions.\n  - `go test ./...` passes, including any updated tests.\n",
        "closed_by":  null,
        "reactions":  {
                          "url":  "https://api.github.com/repos/Cizor/spacetime-constellation-sim/issues/179/reactions",
                          "total_count":  0,
                          "+1":  0,
                          "-1":  0,
                          "laugh":  0,
                          "hooray":  0,
                          "confused":  0,
                          "heart":  0,
                          "rocket":  0,
                          "eyes":  0
                      },
        "timeline_url":  "https://api.github.com/repos/Cizor/spacetime-constellation-sim/issues/179/timeline",
        "performed_via_github_app":  null,
        "state_reason":  null
    },
    {
        "url":  "https://api.github.com/repos/Cizor/spacetime-constellation-sim/issues/182",
        "repository_url":  "https://api.github.com/repos/Cizor/spacetime-constellation-sim",
        "labels_url":  "https://api.github.com/repos/Cizor/spacetime-constellation-sim/issues/182/labels{/name}",
        "comments_url":  "https://api.github.com/repos/Cizor/spacetime-constellation-sim/issues/182/comments",
        "events_url":  "https://api.github.com/repos/Cizor/spacetime-constellation-sim/issues/182/events",
        "html_url":  "https://github.com/Cizor/spacetime-constellation-sim/issues/182",
        "id":  3715603007,
        "node_id":  "I_kwDOQfMfks7dd5o_",
        "number":  182,
        "title":  "[Scope 4][Chunk 12] Add in-memory SBI metrics counters for CDPI, Agents, and Telemetry",
        "user":  {
                     "login":  "Cizor",
                     "id":  11782718,
                     "node_id":  "MDQ6VXNlcjExNzgyNzE4",
                     "avatar_url":  "https://avatars.githubusercontent.com/u/11782718?v=4",
                     "gravatar_id":  "",
                     "url":  "https://api.github.com/users/Cizor",
                     "html_url":  "https://github.com/Cizor",
                     "followers_url":  "https://api.github.com/users/Cizor/followers",
                     "following_url":  "https://api.github.com/users/Cizor/following{/other_user}",
                     "gists_url":  "https://api.github.com/users/Cizor/gists{/gist_id}",
                     "starred_url":  "https://api.github.com/users/Cizor/starred{/owner}{/repo}",
                     "subscriptions_url":  "https://api.github.com/users/Cizor/subscriptions",
                     "organizations_url":  "https://api.github.com/users/Cizor/orgs",
                     "repos_url":  "https://api.github.com/users/Cizor/repos",
                     "events_url":  "https://api.github.com/users/Cizor/events{/privacy}",
                     "received_events_url":  "https://api.github.com/users/Cizor/received_events",
                     "type":  "User",
                     "user_view_type":  "public",
                     "site_admin":  false
                 },
        "labels":  [
                       {
                           "id":  9737890014,
                           "node_id":  "LA_kwDOQfMfks8AAAACRGxo3g",
                           "url":  "https://api.github.com/repos/Cizor/spacetime-constellation-sim/labels/type:feature",
                           "name":  "type:feature",
                           "color":  "942327",
                           "default":  false,
                           "description":  ""
                       },
                       {
                           "id":  9782134341,
                           "node_id":  "LA_kwDOQfMfks8AAAACRw-GRQ",
                           "url":  "https://api.github.com/repos/Cizor/spacetime-constellation-sim/labels/scope:4-sbi",
                           "name":  "scope:4-sbi",
                           "color":  "5a2e28",
                           "default":  false,
                           "description":  ""
                       },
                       {
                           "id":  9782142254,
                           "node_id":  "LA_kwDOQfMfks8AAAACRw-lLg",
                           "url":  "https://api.github.com/repos/Cizor/spacetime-constellation-sim/labels/chunk:12-sbi-observability",
                           "name":  "chunk:12-sbi-observability",
                           "color":  "51f0bd",
                           "default":  false,
                           "description":  ""
                       }
                   ],
        "state":  "open",
        "locked":  false,
        "assignee":  {
                         "login":  "Cizor",
                         "id":  11782718,
                         "node_id":  "MDQ6VXNlcjExNzgyNzE4",
                         "avatar_url":  "https://avatars.githubusercontent.com/u/11782718?v=4",
                         "gravatar_id":  "",
                         "url":  "https://api.github.com/users/Cizor",
                         "html_url":  "https://github.com/Cizor",
                         "followers_url":  "https://api.github.com/users/Cizor/followers",
                         "following_url":  "https://api.github.com/users/Cizor/following{/other_user}",
                         "gists_url":  "https://api.github.com/users/Cizor/gists{/gist_id}",
                         "starred_url":  "https://api.github.com/users/Cizor/starred{/owner}{/repo}",
                         "subscriptions_url":  "https://api.github.com/users/Cizor/subscriptions",
                         "organizations_url":  "https://api.github.com/users/Cizor/orgs",
                         "repos_url":  "https://api.github.com/users/Cizor/repos",
                         "events_url":  "https://api.github.com/users/Cizor/events{/privacy}",
                         "received_events_url":  "https://api.github.com/users/Cizor/received_events",
                         "type":  "User",
                         "user_view_type":  "public",
                         "site_admin":  false
                     },
        "assignees":  [
                          {
                              "login":  "Cizor",
                              "id":  11782718,
                              "node_id":  "MDQ6VXNlcjExNzgyNzE4",
                              "avatar_url":  "https://avatars.githubusercontent.com/u/11782718?v=4",
                              "gravatar_id":  "",
                              "url":  "https://api.github.com/users/Cizor",
                              "html_url":  "https://github.com/Cizor",
                              "followers_url":  "https://api.github.com/users/Cizor/followers",
                              "following_url":  "https://api.github.com/users/Cizor/following{/other_user}",
                              "gists_url":  "https://api.github.com/users/Cizor/gists{/gist_id}",
                              "starred_url":  "https://api.github.com/users/Cizor/starred{/owner}{/repo}",
                              "subscriptions_url":  "https://api.github.com/users/Cizor/subscriptions",
                              "organizations_url":  "https://api.github.com/users/Cizor/orgs",
                              "repos_url":  "https://api.github.com/users/Cizor/repos",
                              "events_url":  "https://api.github.com/users/Cizor/events{/privacy}",
                              "received_events_url":  "https://api.github.com/users/Cizor/received_events",
                              "type":  "User",
                              "user_view_type":  "public",
                              "site_admin":  false
                          }
                      ],
        "milestone":  {
                          "url":  "https://api.github.com/repos/Cizor/spacetime-constellation-sim/milestones/4",
                          "html_url":  "https://github.com/Cizor/spacetime-constellation-sim/milestone/4",
                          "labels_url":  "https://api.github.com/repos/Cizor/spacetime-constellation-sim/milestones/4/labels",
                          "id":  14244293,
                          "node_id":  "MI_kwDOQfMfks4A2VnF",
                          "number":  4,
                          "title":  "Scope 4 – Planning \u0026 Scheduling",
                          "description":  "",
                          "creator":  {
                                          "login":  "Cizor",
                                          "id":  11782718,
                                          "node_id":  "MDQ6VXNlcjExNzgyNzE4",
                                          "avatar_url":  "https://avatars.githubusercontent.com/u/11782718?v=4",
                                          "gravatar_id":  "",
                                          "url":  "https://api.github.com/users/Cizor",
                                          "html_url":  "https://github.com/Cizor",
                                          "followers_url":  "https://api.github.com/users/Cizor/followers",
                                          "following_url":  "https://api.github.com/users/Cizor/following{/other_user}",
                                          "gists_url":  "https://api.github.com/users/Cizor/gists{/gist_id}",
                                          "starred_url":  "https://api.github.com/users/Cizor/starred{/owner}{/repo}",
                                          "subscriptions_url":  "https://api.github.com/users/Cizor/subscriptions",
                                          "organizations_url":  "https://api.github.com/users/Cizor/orgs",
                                          "repos_url":  "https://api.github.com/users/Cizor/repos",
                                          "events_url":  "https://api.github.com/users/Cizor/events{/privacy}",
                                          "received_events_url":  "https://api.github.com/users/Cizor/received_events",
                                          "type":  "User",
                                          "user_view_type":  "public",
                                          "site_admin":  false
                                      },
                          "open_issues":  73,
                          "closed_issues":  0,
                          "state":  "open",
                          "created_at":  "2025-11-29T09:54:27Z",
                          "updated_at":  "2025-12-10T17:09:37Z",
                          "due_on":  null,
                          "closed_at":  null
                      },
        "comments":  0,
        "created_at":  "2025-12-10T15:06:10Z",
        "updated_at":  "2025-12-10T15:06:10Z",
        "closed_at":  null,
        "author_association":  "OWNER",
        "active_lock_reason":  null,
        "sub_issues_summary":  {
                                   "total":  0,
                                   "completed":  0,
                                   "percent_completed":  0
                               },
        "parent_issue_url":  "https://api.github.com/repos/Cizor/spacetime-constellation-sim/issues/178",
        "issue_dependencies_summary":  {
                                           "blocked_by":  0,
                                           "total_blocked_by":  0,
                                           "blocking":  0,
                                           "total_blocking":  0
                                       },
        "body":  "## Background\n\nScope 4 now has:\n\n- CDPI server and agents:\n  - Agents receive scheduled actions (CreateEntry/DeleteEntry/Finalize/Reset).\n  - Agents execute actions and send Responses back to the controller.\n- Telemetry:\n  - `TelemetryService.ExportMetrics` on the controller side.\n  - Agent-side telemetry loop emitting `ExportMetricsRequest` periodically.\n\nChunk 12 is about **observability \u0026 developer experience**. 12.1 added structured logging for CDPI/agents (and possibly Telemetry). The next piece (12.2) is **lightweight in-memory metrics**:\n\n- Simple counters that track “how much SBI is doing” without introducing heavy dependencies.\n- Purely internal (not exported via NBI yet).\n- Usable in:\n  - Unit tests (assert behaviour).\n  - Ad-hoc debugging (dumping metrics to logs or a debug API).\n\nExamples from the Scope 4 plan:\n\n- `num_create_entry_sent`, `num_delete_entry_sent`.\n- `num_actions_executed`, `num_responses_ok`, `num_responses_error`.\n- `num_telemetry_reports`.\n\nThis issue adds a small metrics container + instrumentation points in CDPI, Agent, and Telemetry paths.\n\n## Goal\n\nProvide an in-memory metrics facility that:\n\n- Tracks a small set of SBI counters (CDPI, Agent execution, Telemetry).\n- Is concurrency-safe and cheap to update.\n- Is easy to query/dump for debugging and unit tests.\n- Does **not** introduce new external dependencies (stick to stdlib).\n\n## Where to look\n\n- CDPI server (controller side):\n\n  - Under something like:\n\n        internal/sbi/controller/cdpi_server.go\n\n  - Where Create/Delete/Finalize are sent to agents and Responses are received.\n\n- Agent implementation:\n\n  - Under:\n\n        internal/sbi/agent/agent.go\n\n  - Where actions are scheduled/executed and Responses are written to the stream.\n\n- Telemetry server and state:\n\n  - Telemetry server:\n\n        internal/sbi/telemetry_server.go\n        // or similar\n\n  - Telemetry state:\n\n        internal/sim/state/telemetry_state.go\n        // or sim/state/metrics.go, depending on how you structured Chunk 6.\n\n- Any existing “debug / stats” helpers:\n\n  - Search for:\n    - `Stats`, `Metrics`, `Counters`, `DebugDump`, `DumpState`.\n\n## Tasks\n\n### 1. Define a minimal SBI metrics struct\n\nAdd a small metrics container in an appropriate package, for example:\n\n- New file:\n\n      internal/sbi/metrics.go\n\nDefine something like:\n\n- Per-process SBI metrics:\n\n      type SBIMetrics struct {\n          mu sync.Mutex\n\n          // CDPI → Agent commands\n          NumCreateEntrySent   uint64\n          NumDeleteEntrySent   uint64\n          NumFinalizeSent      uint64\n\n          // Agent-side execution\n          NumActionsExecuted   uint64\n\n          // Agent → CDPI responses\n          NumResponsesOK       uint64\n          NumResponsesError    uint64\n\n          // Telemetry\n          NumTelemetryReports  uint64\n      }\n\nAdd helpers:\n\n- Constructor:\n\n      func NewSBIMetrics() *SBIMetrics\n\n- Increment helpers (so callers don’t touch fields directly):\n\n      func (m *SBIMetrics) IncCreateEntrySent()\n      func (m *SBIMetrics) IncDeleteEntrySent()\n      func (m *SBIMetrics) IncFinalizeSent()\n      func (m *SBIMetrics) IncActionsExecuted()\n      func (m *SBIMetrics) IncResponsesOK()\n      func (m *SBIMetrics) IncResponsesError()\n      func (m *SBIMetrics) IncTelemetryReports()\n\n- Snapshot:\n\n      type SBIMetricsSnapshot struct {\n          NumCreateEntrySent  uint64\n          NumDeleteEntrySent  uint64\n          NumFinalizeSent     uint64\n          NumActionsExecuted  uint64\n          NumResponsesOK      uint64\n          NumResponsesError   uint64\n          NumTelemetryReports uint64\n      }\n\n      func (m *SBIMetrics) Snapshot() SBIMetricsSnapshot\n\nNotes:\n\n- Use a simple `sync.Mutex` (or `sync.RWMutex`) to keep this trivial and safe.\n- Keep the API intentionally small and boring; this is internal infra.\n\n### 2. Wire SBIMetrics into CDPI server\n\nUpdate the CDPI server struct (controller side) to carry a metrics pointer:\n\n- In `internal/sbi/controller/cdpi_server.go` (or equivalent):\n\n      type CDPIServer struct {\n          scheduling.UnimplementedControlDataPlaneInterfaceServer\n\n          State    *simstate.ScenarioState\n          Clock    sbi.EventScheduler\n\n          agentsMu sync.RWMutex\n          agents   map[string]*AgentHandle\n\n          Metrics  *sbi.SBIMetrics  // new field\n      }\n\nDesign notes:\n\n- `Metrics` can be optional:\n  - If `nil`, skip increments.\n  - This keeps tests / callers flexible.\n- Prefer injecting `Metrics` at construction time (e.g. via `NewCDPIServer(...)`).\n\nInstrumentation points:\n\n- In controller → agent send paths (where you already build messages):\n\n      func (s *CDPIServer) SendCreateEntry(...) error {\n          // On success:\n          if s.Metrics != nil {\n              s.Metrics.IncCreateEntrySent()\n          }\n      }\n\n      func (s *CDPIServer) SendDeleteEntry(...) error {\n          if s.Metrics != nil {\n              s.Metrics.IncDeleteEntrySent()\n          }\n      }\n\n      func (s *CDPIServer) SendFinalize(...) error {\n          if s.Metrics != nil {\n              s.Metrics.IncFinalizeSent()\n          }\n      }\n\n- In agent → controller receive path:\n\n  - When you handle Responses in `ReceiveRequests(...)`:\n\n        switch msg := incoming.GetAgentToController().(type) {\n        case *scheduling.ReceiveRequestsMessageFromAgent_Response:\n            // existing status handling...\n            if s.Metrics != nil {\n                if msg.Response.Status == scheduling.Status_STATUS_OK { // adjust to real enum\n                    s.Metrics.IncResponsesOK()\n                } else {\n                    s.Metrics.IncResponsesError()\n                }\n            }\n        }\n\n### 3. Wire SBIMetrics into Agent execution\n\nExtend the Agent struct to accept a metrics pointer:\n\n- In `internal/sbi/agent/agent.go`:\n\n      type Agent struct {\n          AgentID   string\n          NodeID    string\n          State     *simstate.ScenarioState\n          Scheduler sbi.EventScheduler\n\n          // SBI\n          TelemetryClient telemetry.TelemetryServiceClient\n          Stream          scheduling.ControlDataPlaneInterface_ReceiveRequestsClient\n\n          // Scheduling / pending entries...\n          // ...\n\n          Metrics *sbi.SBIMetrics // optional shared pointer from controller or global\n      }\n\nInstrumentation point:\n\n- In the method that executes a scheduled action, e.g.:\n\n      func (a *Agent) execute(action *ScheduledAction) {\n          // existing switch on action.Type, calling ScenarioState.ApplyXXX...\n\n          if a.Metrics != nil {\n              a.Metrics.IncActionsExecuted()\n          }\n\n          // build \u0026 send Response back to controller...\n      }\n\nNotes:\n\n- If you already have multiple execution paths (beam, route, etc.), instrument once per actual “action run” (not per helper call).\n\n### 4. Wire SBIMetrics into TelemetryService\n\nExtend Telemetry server struct:\n\n- In `internal/sbi/telemetry_server.go`:\n\n      type TelemetryServer struct {\n          telemetry.UnimplementedTelemetryServiceServer\n\n          Telemetry *simstate.TelemetryState\n          Metrics   *sbi.SBIMetrics // new, optional\n      }\n\nInstrumentation point:\n\n- In `ExportMetrics`:\n\n      func (s *TelemetryServer) ExportMetrics(ctx context.Context, req *telemetry.ExportMetricsRequest) (*telemetry.ExportMetricsResponse, error) {\n          // existing: translate \u0026 update TelemetryState...\n\n          if s.Metrics != nil {\n              s.Metrics.IncTelemetryReports()\n          }\n\n          return \u0026telemetry.ExportMetricsResponse{}, nil\n      }\n\n### 5. Provide a simple debug dump helper\n\nAdd a small helper that renders the metrics snapshot as a string for logs / debug UIs.\n\n- In `internal/sbi/metrics.go` (same file as SBIMetrics):\n\n      func (m *SBIMetrics) String() string {\n          snap := m.Snapshot()\n          return fmt.Sprintf(\"SBI metrics: create=%d delete=%d finalize=%d executed=%d resp_ok=%d resp_err=%d telemetry_reports=%d\",\n              snap.NumCreateEntrySent,\n              snap.NumDeleteEntrySent,\n              snap.NumFinalizeSent,\n              snap.NumActionsExecuted,\n              snap.NumResponsesOK,\n              snap.NumResponsesError,\n              snap.NumTelemetryReports,\n          )\n      }\n\nOptional:\n\n- Hook this into any existing “dump state” / debug endpoints (or leave for Chunk 12.3 dedicated debug-dump issue).\n\n### 6. Unit tests\n\nAdd tests that verify counters move as expected, in at least these places:\n\n1. **CDPI server send paths**\n\n   - File: `internal/sbi/controller/cdpi_server_metrics_test.go` (or folded into existing tests).\n   - Use a `CDPIServer` with:\n     - `Metrics = NewSBIMetrics()`.\n     - Fake `AgentHandle` / outgoing channel to avoid real network.\n   - Call:\n     - `SendCreateEntry`, `SendDeleteEntry`, `SendFinalize`.\n   - Assert:\n     - `Metrics.Snapshot()` shows the expected increments.\n\n2. **CDPI server Response handling**\n\n   - Simulate incoming Responses with:\n     - `Status = OK`.\n     - `Status = ERROR` (or non-OK).\n   - Assert:\n     - `NumResponsesOK` and `NumResponsesError` are incremented correctly.\n\n3. **Agent execution**\n\n   - File: `internal/sbi/agent/agent_metrics_test.go`.\n   - Create an `Agent` with:\n     - A fake `ScenarioState` that accepts actions without error.\n     - `Metrics = NewSBIMetrics()`.\n   - Call `agent.execute(\u0026ScheduledAction{...})` once or multiple times.\n   - Assert:\n     - `NumActionsExecuted` equals number of executions.\n\n4. **Telemetry server**\n\n   - File: `internal/sbi/telemetry_server_metrics_test.go`.\n   - Create a `TelemetryServer` with:\n     - `TelemetryState` (in-memory).\n     - `Metrics = NewSBIMetrics()`.\n   - Call `ExportMetrics` with a request containing one or more `InterfaceMetrics`.\n   - Assert:\n     - `NumTelemetryReports` incremented by 1 per call (or per request, depending on design; document your choice).\n\n5. **SBIMetrics concurrency/snapshot sanity**\n\n   - Optional but nice:\n     - Use a small test that calls various `Inc*` methods from multiple goroutines.\n     - At the end, call `Snapshot()` and ensure the counts match the sum of increments.\n\n## Acceptance criteria\n\n- `SBIMetrics` type exists with:\n  - Concurrency-safe increment helpers.\n  - `Snapshot()` method returning a plain struct.\n  - `String()` method for human-readable debug dumps.\n\n- CDPI server:\n  - Has an optional `Metrics *SBIMetrics` field.\n  - Increments:\n    - `NumCreateEntrySent` when a CreateEntry is successfully queued/sent.\n    - `NumDeleteEntrySent` when a DeleteEntry is successfully queued/sent.\n    - `NumFinalizeSent` when a FinalizeRequest is sent.\n    - `NumResponsesOK` / `NumResponsesError` when Responses are received from agents.\n\n- Agents:\n  - Have an optional `Metrics *SBIMetrics` field.\n  - Increment `NumActionsExecuted` once per successfully executed scheduled action.\n\n- Telemetry server:\n  - Has an optional `Metrics *SBIMetrics` field.\n  - Increments `NumTelemetryReports` on each `ExportMetrics` call.\n\n- All instrumentation is **best-effort**:\n  - If `Metrics == nil`, behaviour is unchanged.\n  - Metrics updates must not affect control-path correctness (no panics, no blocking on slow paths).\n\n- Tests:\n  - New tests cover:\n    - CDPI send-side counters.\n    - CDPI response counters.\n    - Agent execution counter.\n    - Telemetry reports counter.\n  - All tests pass via `go test ./...`.\n\n- Repository health:\n  - `go build ./...` passes with metrics types and instrumentation in place.\n  - No new external dependencies are introduced for metrics.\n",
        "closed_by":  null,
        "reactions":  {
                          "url":  "https://api.github.com/repos/Cizor/spacetime-constellation-sim/issues/182/reactions",
                          "total_count":  0,
                          "+1":  0,
                          "-1":  0,
                          "laugh":  0,
                          "hooray":  0,
                          "confused":  0,
                          "heart":  0,
                          "rocket":  0,
                          "eyes":  0
                      },
        "timeline_url":  "https://api.github.com/repos/Cizor/spacetime-constellation-sim/issues/182/timeline",
        "performed_via_github_app":  null,
        "state_reason":  null
    },
    {
        "url":  "https://api.github.com/repos/Cizor/spacetime-constellation-sim/issues/198",
        "repository_url":  "https://api.github.com/repos/Cizor/spacetime-constellation-sim",
        "labels_url":  "https://api.github.com/repos/Cizor/spacetime-constellation-sim/issues/198/labels{/name}",
        "comments_url":  "https://api.github.com/repos/Cizor/spacetime-constellation-sim/issues/198/comments",
        "events_url":  "https://api.github.com/repos/Cizor/spacetime-constellation-sim/issues/198/events",
        "html_url":  "https://github.com/Cizor/spacetime-constellation-sim/issues/198",
        "id":  3716033822,
        "node_id":  "I_kwDOQfMfks7dfi0e",
        "number":  198,
        "title":  "[Scope 4][Chunk 12] Add DumpAgentState developer helper function",
        "user":  {
                     "login":  "Cizor",
                     "id":  11782718,
                     "node_id":  "MDQ6VXNlcjExNzgyNzE4",
                     "avatar_url":  "https://avatars.githubusercontent.com/u/11782718?v=4",
                     "gravatar_id":  "",
                     "url":  "https://api.github.com/users/Cizor",
                     "html_url":  "https://github.com/Cizor",
                     "followers_url":  "https://api.github.com/users/Cizor/followers",
                     "following_url":  "https://api.github.com/users/Cizor/following{/other_user}",
                     "gists_url":  "https://api.github.com/users/Cizor/gists{/gist_id}",
                     "starred_url":  "https://api.github.com/users/Cizor/starred{/owner}{/repo}",
                     "subscriptions_url":  "https://api.github.com/users/Cizor/subscriptions",
                     "organizations_url":  "https://api.github.com/users/Cizor/orgs",
                     "repos_url":  "https://api.github.com/users/Cizor/repos",
                     "events_url":  "https://api.github.com/users/Cizor/events{/privacy}",
                     "received_events_url":  "https://api.github.com/users/Cizor/received_events",
                     "type":  "User",
                     "user_view_type":  "public",
                     "site_admin":  false
                 },
        "labels":  [
                       {
                           "id":  9782134341,
                           "node_id":  "LA_kwDOQfMfks8AAAACRw-GRQ",
                           "url":  "https://api.github.com/repos/Cizor/spacetime-constellation-sim/labels/scope:4-sbi",
                           "name":  "scope:4-sbi",
                           "color":  "5a2e28",
                           "default":  false,
                           "description":  ""
                       },
                       {
                           "id":  9782142254,
                           "node_id":  "LA_kwDOQfMfks8AAAACRw-lLg",
                           "url":  "https://api.github.com/repos/Cizor/spacetime-constellation-sim/labels/chunk:12-sbi-observability",
                           "name":  "chunk:12-sbi-observability",
                           "color":  "51f0bd",
                           "default":  false,
                           "description":  ""
                       }
                   ],
        "state":  "open",
        "locked":  false,
        "assignee":  {
                         "login":  "Cizor",
                         "id":  11782718,
                         "node_id":  "MDQ6VXNlcjExNzgyNzE4",
                         "avatar_url":  "https://avatars.githubusercontent.com/u/11782718?v=4",
                         "gravatar_id":  "",
                         "url":  "https://api.github.com/users/Cizor",
                         "html_url":  "https://github.com/Cizor",
                         "followers_url":  "https://api.github.com/users/Cizor/followers",
                         "following_url":  "https://api.github.com/users/Cizor/following{/other_user}",
                         "gists_url":  "https://api.github.com/users/Cizor/gists{/gist_id}",
                         "starred_url":  "https://api.github.com/users/Cizor/starred{/owner}{/repo}",
                         "subscriptions_url":  "https://api.github.com/users/Cizor/subscriptions",
                         "organizations_url":  "https://api.github.com/users/Cizor/orgs",
                         "repos_url":  "https://api.github.com/users/Cizor/repos",
                         "events_url":  "https://api.github.com/users/Cizor/events{/privacy}",
                         "received_events_url":  "https://api.github.com/users/Cizor/received_events",
                         "type":  "User",
                         "user_view_type":  "public",
                         "site_admin":  false
                     },
        "assignees":  [
                          {
                              "login":  "Cizor",
                              "id":  11782718,
                              "node_id":  "MDQ6VXNlcjExNzgyNzE4",
                              "avatar_url":  "https://avatars.githubusercontent.com/u/11782718?v=4",
                              "gravatar_id":  "",
                              "url":  "https://api.github.com/users/Cizor",
                              "html_url":  "https://github.com/Cizor",
                              "followers_url":  "https://api.github.com/users/Cizor/followers",
                              "following_url":  "https://api.github.com/users/Cizor/following{/other_user}",
                              "gists_url":  "https://api.github.com/users/Cizor/gists{/gist_id}",
                              "starred_url":  "https://api.github.com/users/Cizor/starred{/owner}{/repo}",
                              "subscriptions_url":  "https://api.github.com/users/Cizor/subscriptions",
                              "organizations_url":  "https://api.github.com/users/Cizor/orgs",
                              "repos_url":  "https://api.github.com/users/Cizor/repos",
                              "events_url":  "https://api.github.com/users/Cizor/events{/privacy}",
                              "received_events_url":  "https://api.github.com/users/Cizor/received_events",
                              "type":  "User",
                              "user_view_type":  "public",
                              "site_admin":  false
                          }
                      ],
        "milestone":  {
                          "url":  "https://api.github.com/repos/Cizor/spacetime-constellation-sim/milestones/4",
                          "html_url":  "https://github.com/Cizor/spacetime-constellation-sim/milestone/4",
                          "labels_url":  "https://api.github.com/repos/Cizor/spacetime-constellation-sim/milestones/4/labels",
                          "id":  14244293,
                          "node_id":  "MI_kwDOQfMfks4A2VnF",
                          "number":  4,
                          "title":  "Scope 4 – Planning \u0026 Scheduling",
                          "description":  "",
                          "creator":  {
                                          "login":  "Cizor",
                                          "id":  11782718,
                                          "node_id":  "MDQ6VXNlcjExNzgyNzE4",
                                          "avatar_url":  "https://avatars.githubusercontent.com/u/11782718?v=4",
                                          "gravatar_id":  "",
                                          "url":  "https://api.github.com/users/Cizor",
                                          "html_url":  "https://github.com/Cizor",
                                          "followers_url":  "https://api.github.com/users/Cizor/followers",
                                          "following_url":  "https://api.github.com/users/Cizor/following{/other_user}",
                                          "gists_url":  "https://api.github.com/users/Cizor/gists{/gist_id}",
                                          "starred_url":  "https://api.github.com/users/Cizor/starred{/owner}{/repo}",
                                          "subscriptions_url":  "https://api.github.com/users/Cizor/subscriptions",
                                          "organizations_url":  "https://api.github.com/users/Cizor/orgs",
                                          "repos_url":  "https://api.github.com/users/Cizor/repos",
                                          "events_url":  "https://api.github.com/users/Cizor/events{/privacy}",
                                          "received_events_url":  "https://api.github.com/users/Cizor/received_events",
                                          "type":  "User",
                                          "user_view_type":  "public",
                                          "site_admin":  false
                                      },
                          "open_issues":  73,
                          "closed_issues":  0,
                          "state":  "open",
                          "created_at":  "2025-11-29T09:54:27Z",
                          "updated_at":  "2025-12-10T17:09:37Z",
                          "due_on":  null,
                          "closed_at":  null
                      },
        "comments":  0,
        "created_at":  "2025-12-10T16:57:12Z",
        "updated_at":  "2025-12-10T17:02:18Z",
        "closed_at":  null,
        "author_association":  "OWNER",
        "active_lock_reason":  null,
        "sub_issues_summary":  {
                                   "total":  0,
                                   "completed":  0,
                                   "percent_completed":  0
                               },
        "parent_issue_url":  "https://api.github.com/repos/Cizor/spacetime-constellation-sim/issues/178",
        "issue_dependencies_summary":  {
                                           "blocked_by":  0,
                                           "total_blocked_by":  0,
                                           "blocking":  0,
                                           "total_blocking":  0
                                       },
        "body":  "## Background\n\nChunk 12 requires a developer helper function for debugging agent state. This allows developers to inspect agent state during development and debugging without needing to add breakpoints or log statements.\n\n## Goal\n\nImplement a `DumpAgentState` function that returns a human-readable string representation of an agent\u0027s current state, including pending scheduled actions and telemetry metrics.\n\n## Tasks\n\n### 1. Define DumpAgentState function\n\nIn `internal/sbi/agent/agent.go` or `internal/sbi/agent/debug.go`:\n\n```go\n// DumpAgentState returns a human-readable string representation of the\n// agent\u0027s current state for debugging purposes.\nfunc (a *Agent) DumpAgentState() string {\n    a.mu.Lock()\n    defer a.mu.Unlock()\n    \n    var buf strings.Builder\n    buf.WriteString(fmt.Sprintf(\"Agent: %s (NodeID: %s)\\n\", a.AgentID, a.NodeID))\n    buf.WriteString(fmt.Sprintf(\"Token: %s\\n\", a.token))\n    buf.WriteString(fmt.Sprintf(\"Pending Actions: %d\\n\", len(a.pending)))\n    \n    // List pending actions\n    for entryID, action := range a.pending {\n        buf.WriteString(fmt.Sprintf(\"  - %s: %s at %s\\n\", \n            entryID, action.Type, action.When))\n    }\n    \n    return buf.String()\n}\n```\n\n### 2. Integrate with TelemetryState\n\nIf TelemetryState is accessible, include last telemetry metrics:\n\n```go\nfunc (a *Agent) DumpAgentState(telemetry *TelemetryState) string {\n    // ... agent state ...\n    \n    // Add telemetry metrics if available\n    if telemetry != nil {\n        metrics := telemetry.GetMetrics(a.NodeID, \"\")\n        if metrics != nil {\n            buf.WriteString(\"\\nLast Telemetry:\\n\")\n            buf.WriteString(fmt.Sprintf(\"  BytesTx: %d\\n\", metrics.BytesTx))\n            buf.WriteString(fmt.Sprintf(\"  Up: %v\\n\", metrics.Up))\n        }\n    }\n    \n    return buf.String()\n}\n```\n\n### 3. Add CDPI server helper\n\nIn `internal/sbi/controller/cdpi_server.go`:\n\n```go\n// DumpAgentState returns debug info for a specific agent.\nfunc (s *CDPIServer) DumpAgentState(agentID string) (string, error) {\n    s.agentsMu.RLock()\n    defer s.agentsMu.RUnlock()\n    \n    handle, ok := s.agents[agentID]\n    if !ok {\n        return \"\", fmt.Errorf(\"agent %s not found\", agentID)\n    }\n    \n    // If agent is accessible, call its DumpAgentState\n    // Otherwise return handle info\n    return fmt.Sprintf(\"AgentHandle: %s, NodeID: %s, Token: %s\", \n        handle.AgentID, handle.NodeID, handle.token), nil\n}\n```\n\n### 4. Add tests\n\nIn `internal/sbi/agent/agent_test.go`:\n\n```go\nfunc TestAgent_DumpAgentState(t *testing.T) {\n    agent := NewAgent(...)\n    agent.pending[\"entry1\"] = \u0026ScheduledAction{...}\n    \n    dump := agent.DumpAgentState()\n    assert.Contains(t, dump, \"Agent:\")\n    assert.Contains(t, dump, \"entry1\")\n    assert.Contains(t, dump, \"Pending Actions: 1\")\n}\n```\n\n### 5. Optional: Add CLI command or debug endpoint\n\nConsider adding:\n- A debug flag to `cmd/nbi-server` that dumps all agent states\n- Or a debug gRPC method (if not exposing via NBI yet)\n\n## Acceptance Criteria\n\n- `DumpAgentState()` function exists on Agent\n- Returns formatted string with:\n  - AgentID, NodeID\n  - Current token\n  - List of pending scheduled actions (entryID, type, when)\n  - Optional: last telemetry metrics\n- CDPI server has helper to dump agent state\n- Unit tests verify output format\n- Function is thread-safe (uses agent\u0027s mutex)\n- `go test ./internal/sbi/agent/...` passes\n\n## Related Issues\n\n- Part of Chunk 12 epic (#178)\n- Complements logging (#179, #180) and metrics (#181, #182)\n- Useful for debugging Chunk 4 agent behavior",
        "closed_by":  null,
        "reactions":  {
                          "url":  "https://api.github.com/repos/Cizor/spacetime-constellation-sim/issues/198/reactions",
                          "total_count":  0,
                          "+1":  0,
                          "-1":  0,
                          "laugh":  0,
                          "hooray":  0,
                          "confused":  0,
                          "heart":  0,
                          "rocket":  0,
                          "eyes":  0
                      },
        "timeline_url":  "https://api.github.com/repos/Cizor/spacetime-constellation-sim/issues/198/timeline",
        "performed_via_github_app":  null,
        "state_reason":  null
    }
]
